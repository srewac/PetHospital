<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Paper</title>
    <link href="/static/css/bootstrap.css" type="text/css" rel="stylesheet" media="all">
    <link href="/static/css/easy-responsive-tabs.css" rel='stylesheet' type='text/css'/>
    <!-- easy-responsive-tabs -->

    <link href="/static/css/style.css" type="text/css" rel="stylesheet" media="all">
    <link href="/static/css/font-awesome.css" rel="stylesheet">
    <!-- font-awesome icons -->
    <!-- //Custom Theme files -->
    <!-- js -->
    <script src="/static/js/jquery-2.2.3.min.js"></script>
    <!-- //js -->
    <!-- web-fonts -->
    <link href="//fonts.googleapis.com/css?family=Limelight" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Junge" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic'
          rel='stylesheet' type='text/css'>
</head>
<body>
<div class="container" >
    <div style="width: 60%;margin: 0 auto;">
        <h1 style="text-align: center;margin-top: 20px;">考试</h1>
        <br>
        <p>考试科目：{{ selectedtest.test_paper.disease }}</p>
        <p id="remainTime">考试时间：</p>
        <P>截止时间：{{ selectedtest.close_time }}</P>
        <p>考试说明：{{ selectedtest.test_paper.desc }}</p>
    </div>
    <div style="width: 60%;margin: 0 auto;">
        <form action="{% url 'Test:paper' %}" method="POST" onsubmit="return submitcheck()" name="answer">
        {% csrf_token %}
            {% for question in questiones %}
            <hr style="height: 1px;border:none;border-top:1px dashed; margin-top: 20px;">
            <li>{{ forloop.counter }}.  {{ question.text }}<br />
                {% for choice in choice %}
                    {% if choice.question == question %}
                     <input type="radio" style="margin-right: 10px;" value="{{ choice.id }}" name="{{ question.id }}"/><label> {{ choice.text }}</label><br />
                    {% endif %}
                {% endfor %}
            </li>
            {% endfor %}
        <div style="text-align: center;margin-top: 30px;margin-bottom: 70px;">
            <input id="submit_button" type="submit">
        </div>
        </form>
    </div>
</div>
<script type="text/javascript">
    force_submit = false;
    function submitcheck() {
        if(force_submit==true||confirm("确认提交")==true)
            return true;
        else
            return false;
    }
    $(document).ready(function () {
        //这里获取倒计时的起始时间
        SysSecond = {{ selectedtest.duration }}*60;
        if (SysSecond != "" && !isNaN(SysSecond)) {
            InterValObj = window.setInterval(SetRemainTime, 1000); //间隔函数，1秒执行
        }
    });
    function padLeft(str, length) {
        if (str.length >= length)
            return str;
        else
            return padLeft("0" + str, length);
    }
    function SetRemainTime() {
        if (SysSecond > 0) {
            SysSecond = SysSecond - 1;
            var second = padLeft(Math.floor(SysSecond % 60),1);             // 计算秒
            var minute = padLeft(Math.floor((SysSecond / 60) % 60),1);      //计算分
            var hour = Math.floor((SysSecond / 3600) % 24);      //计算小时
            //var day = Math.floor((SysSecond / 3600) / 24);        //计算天

            $("#remainTime").html("考试时间："+hour+":"+minute + ":" + second);
        } else {
            //剩余时间小于或等于0的时候，就停止间隔函数
            alert("Time is up.");
            window.clearInterval(InterValObj);
            //这里可以添加倒计时时间为0后需要执行的事件
            force_submit=true;
            document.getElementById("submit_button").click();

        }
    }



</script>
</body>
</html>
